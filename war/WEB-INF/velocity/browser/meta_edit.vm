#* ========================================================================
 * Copyright (c) 2009-2014 The University of Washington
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================================
 *#

##
## Templates for rp edit 
##

<div id="metaEditDialog" data-dojo-type="dijit/Dialog" title="Edit metadata" $hide
  onShow="metaEditShow()" onHide="metaEditHide()" onKeyPress="metaEditKey()" onClick="metaEditKey()">

## <div id="metarnotice" class="rnotice">(<span class="rstar">*</span> required field)</div>

<div class="dijitDialogPaneContentArea" data-dojo-type="dijit/layout/ContentPane">


<h3 tabindex="0">Edit metadata for ${relyingParty.entityId}</h3>

#if ( $newEntity )
 #if ( $newByLookup )
   This metadata was generated by the Service Provider's Metadata response.
 #else
   The metadata details are only guesses.  You must verify them.
 #end
#end

<h3>Organization</h3>

<ul class="iamlist">
## Organization
   #set ( $count = 0 )

   #set ( $org = $relyingParty.organization )

     <li id="org0_0">
      <h4 class="dt">Name:${rstar}</h4>
         <div class="dd"><input aria-label="org name. required entry" data-dojo-type="dijit.form.TextBox" id="orgn_0" value="#X($!org.name)" /></div>
     </li>
     <li id="org0_1">
      <h4 class="dt" >Display:$rstar</h4>
         <div class="dd"><input aria-label="org display name, required" data-dojo-type="dijit.form.TextBox" id="orgd_0" value="#X($!org.displayName)" /></div>
     </li>
     <li id="org0_2">
      <h4 class="dt" >Url:$rstar</h4>
         <div class="dd"><input aria-label="org url, required" data-dojo-type="dijit.form.TextBox" id="orgu_0" value="#X($!org.url)" /></div>
     </li>
     #set ( $count = $count + 1)

 
 ## Contacts
    <li>
      <h4 class="dt">Contacts</h4>
       <div class="dd">
   #set ( $count = 0 )
   #foreach ( $ct in $relyingParty.contactPersons )
   <fieldset>
   <legend class="accessibility">contact number $count</legend>
        <ul class="iamlist">
     <li id="ct${count}_0">
       <span class="dt dt3" >Type</span>
       <select class="dd" id="ctt_${count}" data-dojo-type="dijit.form.Select" aria-label="contact type">
       #foreach ( $t in ["technical","support","administrative","billing","other"] )
         <option value="$t" 
           #if ( $t == $ct.type )
             selected="selected"
           #end
         >$t</option>
       #end
       </select>
            <button dojoType="dijit.form.Button" class="xbutton" title="delete this contact" style="margin-left:10px"
             onClick="meta_clearCT('${count}')">x</button>
     </li>
     <li id="ct${count}_1"><span class="dt dt3">Name$rstar</span>
        <input class="dd" data-dojo-type="dijit.form.TextBox" id="ctgn_${count}" value="#X($!ct.givenName)"  aria-label="name, required" />
     </li>
     <li id="ct${count}_2"><span class="dt dt3">Email$rstar</span>
        <input class="dd" data-dojo-type="dijit.form.TextBox" id="cte_${count}" value="#X($!ct.email)" aria-label="email, required" />
     </li>
     <li id="ct${count}_3"><span class="dt dt3">Phone</span>
        <input class="dd" data-dojo-type="dijit.form.TextBox" id="ctp_${count}" value="#X($!ct.phone)" aria-label="phone"/>
     </li>
     <li><div class="dt dt3" style="height:.5em"></div></li>
     <ul>
     </fieldset>
     #if ($count == 0 )
        <i>At least two contacts are recommended.</i>
     #end
     #set ( $count = $count + 1)
   #end

   #foreach ( $i in [ $count .. 4 ] )
   <fieldset>
   <legend class="accessibility">contact number $i</legend>
        <ul class="iamlist">
     <li id="ct${i}_0" #if ( $i > 0 ) ${hide} #end >
       <span class="dt dt3" >Type</span>
       <select class="dd" id="ctt_${i}"  data-dojo-type="dijit.form.Select" aria-label="contact type">
       #foreach ( $t in ["","technical","support","administrative","billing","other"] )
         <option value="$t" 
           #if ( $t == " " )
             selected="selected"
           #end
         >$t</option>
       #end
       </select>
            <button dojoType="dijit.form.Button" class="xbutton" title="delete this contact" style="margin-left:10px"
             onClick="meta_clearCT('${i}')">x</button>
     </li>
     <li id="ct${i}_1" #if ( $i > 0 ) ${hide} #end >
      <span class="dt dt3" >Name$rstar</span>
        <input class="dd" data-dojo-type="dijit.form.TextBox" id="ctgn_${i}" value="" aria-label="Name, required" />
     </li>
     <li id="ct${i}_2" #if ( $i > 0 ) ${hide} #end >
      <label class="dt dt3" >Email$rstar</label>
        <input class="dd" data-dojo-type="dijit.form.TextBox" id="cte_${i}" value="" aria-label="email, required" />
     </li>
     <li id="ct${i}_3" #if ( $i > 0 ) ${hide} #end >
      <span class="dt dt3">Phone</span>
        <input class="dd" data-dojo-type="dijit.form.TextBox" id="ctp_${i}" value="" aria-label="phone"/>
     </li>
     </ul>
     #set ( $label = "" )
   </fieldset>
   #end
   <div id="ct_more">
    <span class="dt dt3">
       <button dojoType="dijit.form.Button" class="ddbutton" onClick="meta_showMoreFields('ct', 'ct_more')">Add contact</button>
    </span>
   </div>
  </li>
</ul>

## Details

<h3>Metadata details</h3>

<ul class="iamlist">
 ## ProtocolSupportEnumerations
 ## protocolSupportEnumeration="urn:oasis:names:tc:SAML:2.0:protocol urn:oasis:names:tc:SAML:1.1:protocol urn:oasis:names:tc:SAML:1.0:protocol">

 #set ($p10 = "")
 #set ($p11 = "")
 #set ($p20 = "")
 #foreach ( $ps in $relyingParty.protocolSupportEnumerations )
    #if ($ps == "urn:oasis:names:tc:SAML:1.0:protocol") #set ($p10=$checked) #end
    #if ($ps == "urn:oasis:names:tc:SAML:1.1:protocol") #set ($p11=$checked) #end
    #if ($ps == "urn:oasis:names:tc:SAML:2.0:protocol") #set ($p20=$checked) #end
 #end
    <li><h4 class="dt">Protocols</h4>
      <div class="dd">
       <ul class="iamlist">
        <li>
         <input data-dojo-type="dijit.form.CheckBox" id="pse_10" aria-labelledby="pse_10p" $p10/>
         <span id="pse_10p">urn:oasis:names:tc:SAML:1.0:protocol</span>
        </li>
        <li>
         <input data-dojo-type="dijit.form.CheckBox" id="pse_11" aria-labelledby="pse_11p" $p11/>
         <span id="pse_11p">urn:oasis:names:tc:SAML:1.1:protocol</span>
        </li>
        <li>
         <input data-dojo-type="dijit.form.CheckBox" id="pse_20" aria-labelledby="pse_20p" $p20/>
         <span id="pse_20p">urn:oasis:names:tc:SAML:2.0:protocol</span>
        </li>
      </ul></div>
   </li>
 
   ## KeyInfo

      <li><h4 class="dt">KeyInfo</h4>
       <div class="dd">
        <ul class="iamlist">
   #set ( $count = 0 )
   #foreach ( $key in $relyingParty.keyDescriptors )
      <li id="ki${count}_0">
        <span class="dt dt3" >Name</span>
        <input class="dd" data-dojo-type="dijit/form/TextBox" name="keyName_${count}" id="kn_${count}" value="$!key.keyName" aria-label="name"/>
      </li>

      <li id="ki${count}_1">
        <span class="dt dt3" >Cert PEM<br>
            <button dojoType="dijit.form.Button" class="xbutton" title="delete this keyinfo"
             onClick="meta_clearKI('${count}')">x</button>
           </span>
        <textarea data-dojo-type="dijit/form/Textarea" class="dd certbox" cols="64" rows="5" name="keyCert_${count}" id="kc_${count}"
               style="font-size:8px;min-height:3em;" aria-label="cert pem">$!key.certificate</textarea>
      </li>
     #set ( $count = $count + 1)
   #end

   #foreach ( $i in [ $count .. 3 ] )
   
      <li id="ki${i}_0" ${hide}>
      <span class="dt dt3" >Name</span>
        <input class="dd" data-dojo-type="dijit.form.TextBox" name="keyName_${i}" id="kn_${i}" value="" aria-label="name"/>
      </li>
      <li id="ki${i}_1" ${hide}>
      <span class="dt dt3" >Cert PEM</span>
         <textarea data-dojo-type="dijit/form/Textarea" class="dd certbox" cols="64" rows="10" name="keyCert_${i}" id="kc_${i}"
             style="font-size:8px;min-height:3em;"  aria-label="cert pem"></textarea>
      </li>

   #end
   <li id="ki_more">
    <span class="dt dt3">
       <button dojoType="dijit.form.Button" class="ddbutton" onClick="meta_showMoreFields('ki', 'ki_more')">Add keyinfo</button>
    </span>
   </li>
    </ul></div>
   </li>

 
   ## Nameid

#*  no nameid for now 

      <li><h4 class="dt">NameID</h4>
       <div class="dd">
        <ul class="iamlist">
   #set ( $count = 0 )
   #foreach ( $name in $relyingParty.nameIDFormats )
     <li id="ni${count}_0">
      <input class="dd" data-dojo-type="dijit.form.TextBox" name="nameId_${count}" id="ni_${count}" value="$name" aria-label="nameid"/>
     </li>
     #set ( $count = $count + 1)
   #end

   #foreach ( $i in [ $count .. 4 ] )
     <li id="ni${i}_0" ${hide}>
      <input class="dd" data-dojo-type="dijit.form.TextBox" name="nameId_${xtra}" id="ni_${i}" value="" aria-label="nameid"/></td>
     </li>
   #end
   <li id="hi_more">
    <span class="dt dt3">
       <button dojoType="dijit.form.Button" class="ddbutton" onClick="meta_showMoreFields('ni', 'ni_more')">Add nameinfo</button>
    </span>
   </li>
    </ul></div>
   </li>
*#
 
   ## ACS
#set ($bind1="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST")
#set ($bind2="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST-SimpleSign")
#set ($bind4="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact")
#set ($bind3="urn:oasis:names:tc:SAML:2.0:bindings:PAOS")
#set ($bind5="urn:oasis:names:tc:SAML:1.0:profiles:browser-post")
#set ($bind6="urn:oasis:names:tc:SAML:1.0:profiles:artifact-01")

      <li><h4 class="dt">ACS</h4>
       <div class="dd">
        <ul class="iamlist">
   #set ( $count = 0 )
   #foreach ( $acs in $relyingParty.assertionConsumerServices )
     <li id="acs${count}_0">
        <input class="dt dt2" data-dojo-type="dijit.form.TextBox" size="2" id="acsi_${count}"
             value="$acs.index" aria-label="acs index"/>

        ## <input class="dd" data-dojo-type="dijit.form.TextBox" id="acsb_${count}"
        ##       value="$acs.binding" size="30" style="width:400px" aria-label="binding"/>

       <select class="dd" id="acsb_${count}" data-dojo-type="dijit.form.Select" aria-label="binding">
       #foreach ( $t in [$bind1, $bind2, $bind3, $bind4, $bind5, $bind6] )
         <option value="$t" 
           #if ( $t == $acs.binding )
             selected="selected"
           #end
         >$t</option>
       #end
       </select>

     </li>
     <li id="acs${count}_1">
        <span class="dt dt2">
       <button dojoType="dijit.form.Button" class="xbutton" title="delete acs $acs.index"
             onClick="meta_clearACS('${count}')">x</button>
          </span>
        <input class="dd" data-dojo-type="dijit.form.TextBox" id="acsl_${count}"
             value="$acs.location"  size="30" style="width:400px" aria-label="location"/>
     </li>
     <li><div class="dt" style="height:.5em"></div></li>
     #set ( $count = $count + 1)
   #end

   #foreach ( $i in [ $count .. 49 ] )
     <li id="acs${i}_0" ${hide}>
        <input class="dt dt2" data-dojo-type="dijit.form.TextBox" size="2" id="acsi_${i}"
             value="" placeholder="#" aria-label="index" />

##         <input class="dd" data-dojo-type="dijit.form.TextBox" id="acsb_${i}"
##             value="" placeholder="binding" aria-label="binding" size="30" />
       <select class="dd" id="acsb_${i}" data-dojo-type="dijit.form.Select" aria-label="binding">
       #foreach ( $t in [$bind1, $bind2, $bind3, $bind4, $bind5] )
         <option value="$t">$t</option>
       #end
       </select>

     </li>
     <li id="acs${i}_1" ${hide}>
        <div class="dt dt2" role="presentation"></div>
        <input class="dd" data-dojo-type="dijit.form.TextBox" id="acsl_${i}"
            value="" placeholder="location" aria-label="location" size="30" />
     </li>
   #end
   <li id="acs_more">
    <span class="dt dt3">
       <button dojoType="dijit.form.Button" class="ddbutton" onClick="meta_showMoreFields('acs', 'acs_more')">Add ACS</button>
    </span>
   </li>

    </ul></div>
   </li>
</div>
 <div class="dijitDialogPaneActionBar">
    <button dojoType="dijit.form.Button" id="metaEditSaver" disabled="disabled" type="button" onClick="saveRP('${relyingParty.entityId}')">Save changes</button>
    <button dojoType="dijit.form.Button" type="button" onClick="iam_hideTheDialog('metaEditDialog')">Close</button>
 </div>

</div>

## delete dialog

<div id="metaDeleteDialog" data-dojo-type="dijit/Dialog" title="Metadata delete" $hide>
<h3>Permanently delete ${relyingParty.entityId}?</h3>
 <div class="dijitDialogPaneActionBar">
    <button dojoType="dijit.form.Button" type="button" onClick="deleteRP('${relyingParty.entityId}')">Yes, delete</button>
    <button dojoType="dijit.form.Button" type="button" onClick="iam_hideTheDialog('metaDeleteDialog')">Cancel</button>
 </div>
</div>

## new not saved dialog

<div id="metaNotSavedDialog" data-dojo-type="dijit/Dialog" title="Metadata not saved" $hide>
<h3>Your changes have not been saved.<p>Close anyway?</h3>
 <div class="dijitDialogPaneActionBar">
    <button dojoType="dijit.form.Button" type="button">Yes, close
        <script type="dojo/on" data-dojo-event="click">
          iam_hideTheDialog('metaNotSavedDialog');
          showHomePage();
        </script>
    </button>
    <button dojoType="dijit.form.Button" type="button">No, go back
        <script type="dojo/on" data-dojo-event="click">
           iam_hideTheDialog('metaNotSavedDialog');
           iam_showTheDialog('metaEditDialog');
        </script>
    </button>
 </div>
</div>

